#!/bin/bash

IMAGE=dpretty

USER_DIR="$(pwd)"

ENGINE_OPTS="-v \"${USER_DIR}:/user_dir\" -it"

SCRIPTDIR="$(dirname "$(readlink -fn "$0")")"
cd "$SCRIPTDIR"

if [ -x "$(which podman)" ]; then
   ENGINE=podman
elif [ -x "$(which docker)" ]; then
   ENGINE=docker
else
   echo "Podman (recommended) or docker must be installed"
fi

if ! ./hide-short-output.sh $ENGINE build . -t $IMAGE; then
    echo "'$ENGINE build -t .' failed"
    exit 1
fi

$ENGINE run $ENGINEOPTS $IMAGE "$@"

#       bash /dpretty.sh -g /user_dir -r '${upstream}..'
